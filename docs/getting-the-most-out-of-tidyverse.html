<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Chapter 12 Getting the most out of tidyverse | Advancing in R</title>
<meta name="author" content="Philip T. Leftwich">
<meta name="description" content="Quick recap of the key components of the Tidyverse ecosystem. Emphasizing the principles of tidy data and data manipulation.  12.1 Reading files with readr  12.1.1 Cleaning column names Reading a...">
<meta name="generator" content="bookdown 0.34 with bs4_book()">
<meta property="og:title" content="Chapter 12 Getting the most out of tidyverse | Advancing in R">
<meta property="og:type" content="book">
<meta property="og:url" content="https://ueabio.github.io/physalia-R-course-2023/getting-the-most-out-of-tidyverse.html">
<meta property="og:image" content="https://ueabio.github.io/physalia-R-course-2023/images/logos/twitter_card.png">
<meta property="og:description" content="Quick recap of the key components of the Tidyverse ecosystem. Emphasizing the principles of tidy data and data manipulation.  12.1 Reading files with readr  12.1.1 Cleaning column names Reading a...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Chapter 12 Getting the most out of tidyverse | Advancing in R">
<meta name="twitter:description" content="Quick recap of the key components of the Tidyverse ecosystem. Emphasizing the principles of tidy data and data manipulation.  12.1 Reading files with readr  12.1.1 Cleaning column names Reading a...">
<meta name="twitter:image" content="https://ueabio.github.io/physalia-R-course-2023/images/logos/twitter_card.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><script src="libs/bs3compat-0.5.0/transition.js"></script><script src="libs/bs3compat-0.5.0/tabs.js"></script><script src="libs/bs3compat-0.5.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/font-awesome-5.13.0/js/script.js"></script><script src="libs/kePrint-0.0.1/kePrint.js"></script><link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=G-6NP3MF25W3"></script><script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());

      gtag('config', 'G-6NP3MF25W3');
    </script><script language="javascript"> 
        function toggle(id) {
            var ele = document.getElementById("toggleText" + id);
            var text = document.getElementById("displayText" + id);
            var buttonText = text.innerHTML.replace("Show ", "");
            buttonText = buttonText.replace("Hide ", "");
            if(ele.style.display == "block") {
                ele.style.display = "none";
                text.innerHTML = "Show " + buttonText;
            } else {
                ele.style.display = "block";
                text.innerHTML = "Hide " + buttonText;
            }
        } 
    </script><script language="javascript">
        function openCode(evt, codeName, id) {
            var i, tabcontent, tablinks;
            tabcontent = document.getElementsByClassName("tabcontent" + id);
            for (i = 0; i < tabcontent.length; i++) {
                tabcontent[i].style.display = "none";
            }
            tablinks = document.getElementsByClassName("tablinks" + id);
            for (i = 0; i < tablinks.length; i++) {
                tablinks[i].className = tablinks[i].className.replace(" active", "");
            }
            document.getElementById(codeName).style.display = "block";
            evt.currentTarget.className += " active";
        }
    </script><script language="javascript">
        function hide(id){
            document.getElementById(id).style.display = "none";
        }
    </script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<style type="text/css">
    /* Used with Pandoc 2.11+ new --citeproc when CSL is used */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
        }
    .hanging div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }
  </style>
<link rel="stylesheet" href="include/psyteachr.css">
<link rel="stylesheet" href="include/webex.css">
<link rel="stylesheet" href="include/style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="A guide for Biologists and Ecologists">Advancing in R</a>:
        <small class="text-muted">A guide for Biologists and Ecologists</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">Overview</a></li>
<li class="book-part">Get Started in R</li>
<li><a class="" href="introduction-to-r-and-rstudio.html"><span class="header-section-number">1</span> Introduction to R and RStudio</a></li>
<li><a class="" href="r-basics.html"><span class="header-section-number">2</span> R basics</a></li>
<li class="book-part">Exploring Data</li>
<li><a class="" href="loading-data.html"><span class="header-section-number">3</span> Loading data</a></li>
<li><a class="" href="data-wrangling-part-one.html"><span class="header-section-number">4</span> Data wrangling part one</a></li>
<li><a class="" href="data-wrangling-part-two.html"><span class="header-section-number">5</span> Data wrangling part two</a></li>
<li class="book-part">BONUS: Automated Exploratory Analysis</li>
<li><a class="" href="packages-for-automated-exploratory-data-analysis.html"><span class="header-section-number">6</span> Packages for Automated Exploratory Data Analysis</a></li>
<li class="book-part">Functional Programming</li>
<li><a class="" href="writing-functions.html"><span class="header-section-number">7</span> Writing Functions</a></li>
<li><a class="" href="flow-control.html"><span class="header-section-number">8</span> Flow control</a></li>
<li><a class="" href="apply.html"><span class="header-section-number">9</span> Apply</a></li>
<li><a class="" href="purrr.html"><span class="header-section-number">10</span> Purrr</a></li>
<li><a class="" href="bonus-simulation.html"><span class="header-section-number">11</span> Bonus: Simulation</a></li>
<li class="book-part">Getting the most out of tidyverse</li>
<li><a class="active" href="getting-the-most-out-of-tidyverse.html"><span class="header-section-number">12</span> Getting the most out of tidyverse</a></li>
<li class="book-part">Data Presentation</li>
<li><a class="" href="data-visualisation-with-ggplot2.html"><span class="header-section-number">13</span> Data visualisation with ggplot2</a></li>
<li><a class="" href="extensions-for-ggplot2.html"><span class="header-section-number">14</span> Extensions for ggplot2</a></li>
<li><a class="" href="making-tables-with-gt.html"><span class="header-section-number">15</span> Making tables with gt</a></li>
<li class="book-part">Introduction to Shiny</li>
<li><a class="" href="getting-to-work-with-shiny.html"><span class="header-section-number">16</span> Getting to work with Shiny</a></li>
<li><a class="" href="layout.html"><span class="header-section-number">17</span> Layout</a></li>
<li><a class="" href="make-our-own-app.html"><span class="header-section-number">18</span> Make our own App</a></li>
<li><a class="" href="inputs.html"><span class="header-section-number">19</span> Inputs</a></li>
<li><a class="" href="outputs.html"><span class="header-section-number">20</span> Outputs</a></li>
<li><a class="" href="reactive.html"><span class="header-section-number">21</span> Reactive</a></li>
<li><a class="" href="customising.html"><span class="header-section-number">22</span> Customising</a></li>
<li><a class="" href="modules.html"><span class="header-section-number">23</span> Modules</a></li>
<li><a class="" href="sharing.html"><span class="header-section-number">24</span> Sharing</a></li>
<li class="book-part">Literate Programming and Reproducibility</li>
<li><a class="" href="markdown.html"><span class="header-section-number">25</span> Markdown</a></li>
<li><a class="" href="github.html"><span class="header-section-number">26</span> Github</a></li>
<li class="book-part">R Programming</li>
<li><a class="" href="functions-1.html"><span class="header-section-number">27</span> Functions</a></li>
<li><a class="" href="iteration.html"><span class="header-section-number">28</span> Iteration</a></li>
<li><a class="" href="startingR.html"><span class="header-section-number">29</span> Starting up R</a></li>
<li><a class="" href="session-1-foundations-of-programming-in-r.html"><span class="header-section-number">30</span> Session 1: Foundations of Programming in R</a></li>
<li><a class="" href="r-basics-1.html"><span class="header-section-number">31</span> R Basics</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/UEABIO/physalia-intro-stats-2023">View book source <i class="fab fa-github"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="getting-the-most-out-of-tidyverse" class="section level1" number="12">
<h1>
<span class="header-section-number">12</span> Getting the most out of tidyverse<a class="anchor" aria-label="anchor" href="#getting-the-most-out-of-tidyverse"><i class="fas fa-link"></i></a>
</h1>
<p>Quick recap of the key components of the Tidyverse ecosystem.
Emphasizing the principles of tidy data and data manipulation.</p>
<div id="reading-files-with-readr" class="section level2" number="12.1">
<h2>
<span class="header-section-number">12.1</span> Reading files with <code>readr</code><a class="anchor" aria-label="anchor" href="#reading-files-with-readr"><i class="fas fa-link"></i></a>
</h2>
<div id="cleaning-column-names" class="section level3" number="12.1.1">
<h3>
<span class="header-section-number">12.1.1</span> Cleaning column names<a class="anchor" aria-label="anchor" href="#cleaning-column-names"><i class="fas fa-link"></i></a>
</h3>
<p>Reading a CSV file often requires some data cleaning. For example, let's say I want to import data and convert all column names to <code>snake_case</code>.</p>
<p>Most of us would probably read the .CSV file first, then start data cleaning - for example with the <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">janitor::clean_names()</a></code> function.</p>
<div class="sourceCode" id="cb212"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sfirke/janitor">janitor</a></span><span class="op">)</span></span>
<span><span class="co">#load data</span></span>
<span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span> <span class="op">(</span><span class="st">"data/penguins_raw.csv"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">penguins</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">janitor</span><span class="fu">::</span><span class="fu"><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names</a></span><span class="op">(</span><span class="va">penguins</span><span class="op">)</span> </span></code></pre></div>
<p>In my previous example, I used the <code><a href="https://sfirke.github.io/janitor/reference/clean_names.html">clean_names()</a></code> function from the "janitor" package to convert the column names to lowercase. You can achieve the same result by using the <code><a href="https://sfirke.github.io/janitor/reference/make_clean_names.html">make_clean_names()</a></code> function within the <code>read_csv</code> function, specifying it in the <code>name_repair</code> argument.</p>
<div class="sourceCode" id="cb213"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span> <span class="op">(</span><span class="st">"data/penguins_raw.csv"</span>,</span>
<span>                      name_repair <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va"><a href="https://sfirke.github.io/janitor/reference/make_clean_names.html">make_clean_names</a></span><span class="op">)</span></span></code></pre></div>
<p>By default the <code><a href="https://sfirke.github.io/janitor/reference/make_clean_names.html">janitor::make_clean_names</a></code> function has a default argument of <code>snake_case</code> but within the function there is also a <code>case</code> argument where other common naming conventions can be used.</p>
</div>
<div id="selecting-columns" class="section level3" number="12.1.2">
<h3>
<span class="header-section-number">12.1.2</span> Selecting columns<a class="anchor" aria-label="anchor" href="#selecting-columns"><i class="fas fa-link"></i></a>
</h3>
<p>In addition to cleaning your column names, you can also directly select columns while using the "read_csv" function by utilizing the "col_select" argument. This can be extremely useful when working with large files, selecting only the columns you need can be memory-efficient.</p>
<div class="sourceCode" id="cb214"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span> <span class="op">(</span><span class="st">"data/penguins_raw.csv"</span>,</span>
<span>                      name_repair <span class="op">=</span> <span class="fu">janitor</span><span class="fu">::</span><span class="va"><a href="https://sfirke.github.io/janitor/reference/make_clean_names.html">make_clean_names</a></span>,</span>
<span>                      col_select <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">body_mass_g</span>, <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div id="reading-multiple-files" class="section level2" number="12.2">
<h2>
<span class="header-section-number">12.2</span> Reading multiple files<a class="anchor" aria-label="anchor" href="#reading-multiple-files"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb215"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/files2.html">dir.create</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"data/many_files"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">peng_samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">25</span>, <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span><span class="va">penguins</span>, n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://purrr.tidyverse.org/reference/imap.html">iwalk</a></span><span class="op">(</span><span class="va">peng_samples</span>, <span class="op">~</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/write_delim.html">write_csv</a></span><span class="op">(</span><span class="va">.</span>, <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"data/many_files/"</span>, <span class="va">.y</span>, <span class="st">".csv"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div id="create-a-vector-of-file-paths" class="section level3" number="12.2.1">
<h3>
<span class="header-section-number">12.2.1</span> Create a vector of file paths<a class="anchor" aria-label="anchor" href="#create-a-vector-of-file-paths"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb216"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csv_files_list_files</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.files.html">list.files</a></span><span class="op">(</span>path <span class="op">=</span> <span class="st">"data/many_files"</span>,</span>
<span>                                    pattern <span class="op">=</span> <span class="st">"csv"</span>, full.names <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<pre><code> [1] "data/many_files/1.csv"  "data/many_files/10.csv" "data/many_files/11.csv" "data/many_files/12.csv"
 [5] "data/many_files/13.csv" "data/many_files/14.csv" "data/many_files/15.csv" "data/many_files/16.csv"
 [9] "data/many_files/17.csv" "data/many_files/18.csv" "data/many_files/19.csv" "data/many_files/2.csv" 
[13] "data/many_files/20.csv" "data/many_files/21.csv" "data/many_files/22.csv" "data/many_files/23.csv"
[17] "data/many_files/24.csv" "data/many_files/25.csv" "data/many_files/3.csv"  "data/many_files/4.csv" 
[21] "data/many_files/5.csv"  "data/many_files/6.csv"  "data/many_files/7.csv"  "data/many_files/8.csv" 
[25] "data/many_files/9.csv"</code></pre>
<p>The function "list.files" has several arguments. Here's an explanation of some key arguments:</p>
<ul>
<li><p>"path": This argument allows you to specify the directory where your files are located. It's essential to ensure the path is set correctly. You should be working within an R-Studio project or have defined your working directory to avoid issues.</p></li>
<li><p>"pattern": You provide a regular expression in this argument to filter the files you want to list. In your example, you mentioned that you are looking for files containing the string "csv." This helps narrow down the selection to specific file types or patterns.</p></li>
<li><p>"full.names": Setting this argument to <code>TRUE</code> indicates that you want to store the full paths of the files, not just their names. This is important for ensuring you can correctly access and read these files later. If "full.names" is not set to <code>TRUE</code>, you may encounter difficulties when attempting to read the files because the file paths would be incomplete.</p></li>
</ul>
</div>
<div id="read-multiple-files" class="section level3" number="12.2.2">
<h3>
<span class="header-section-number">12.2.2</span> Read multiple files<a class="anchor" aria-label="anchor" href="#read-multiple-files"><i class="fas fa-link"></i></a>
</h3>
<p>Now that we have obtained the file paths, we can proceed to load the files into R. The preferred method in the tidyverse is to use the <code>map_dfr</code> function from the <code>purrr</code> package. This function iterates through all the file paths and combines the data frames into a single, unified data frame. In the following code, <code>.x</code> represents the file name or path. To read and output the actual content of the CSV files (not just the filenames), you should include <code>.x</code> (the path) within a <code>readr</code> function. While this example deals with CSV files, this approach works similarly for other rectangular file formats.</p>
<div class="sourceCode" id="cb218"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map_dfr.html">map_dfr</a></span><span class="op">(</span><span class="va">csv_files_list_files</span>,</span>
<span>              <span class="op">~</span> <span class="fu"><a href="https://readr.tidyverse.org/reference/read_delim.html">read_csv</a></span><span class="op">(</span><span class="va">.x</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span></span></code></pre></div>
<div id="selecting-files" class="section level4" number="12.2.2.1">
<h4>
<span class="header-section-number">12.2.2.1</span> Selecting files<a class="anchor" aria-label="anchor" href="#selecting-files"><i class="fas fa-link"></i></a>
</h4>
<p><code><a href="https://stringr.tidyverse.org/reference/str_detect.html">stringr::str_detect()</a></code></p>
<div class="sourceCode" id="cb219"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csv_files_list_files</span><span class="op">[</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">csv_files_list_files</span>, pattern <span class="op">=</span> <span class="st">"[2-4]"</span>,</span>
<span>negate <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code> [1] "data/many_files/12.csv" "data/many_files/13.csv" "data/many_files/14.csv"
 [4] "data/many_files/2.csv"  "data/many_files/20.csv" "data/many_files/21.csv"
 [7] "data/many_files/22.csv" "data/many_files/23.csv" "data/many_files/24.csv"
[10] "data/many_files/25.csv" "data/many_files/3.csv"  "data/many_files/4.csv"</code></pre>
<div class="sourceCode" id="cb221"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">csv_files_list_files</span><span class="op">[</span><span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">csv_files_list_files</span>, pattern <span class="op">=</span> <span class="st">"[24]\\.csv$"</span><span class="op">)</span><span class="op">]</span></span></code></pre></div>
<pre><code>[1] "data/many_files/12.csv" "data/many_files/14.csv" "data/many_files/2.csv" 
[4] "data/many_files/22.csv" "data/many_files/24.csv" "data/many_files/4.csv"
</code></pre>
</div>
</div>
</div>
<div id="working-across-columns" class="section level2" number="12.3">
<h2>
<span class="header-section-number">12.3</span> Working across columns<a class="anchor" aria-label="anchor" href="#working-across-columns"><i class="fas fa-link"></i></a>
</h2>
<p>In this section we will go through the following functions:</p>
<ul>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col()</a></code></p></li>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with()</a></code></p></li>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">ends_with()</a></code></p></li>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains()</a></code></p></li>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches()</a></code></p></li>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">num_range()</a></code></p></li>
<li><p><code><a href="https://tidyselect.r-lib.org/reference/where.html">where()</a></code></p></li>
</ul>
<div id="select-the-last-column" class="section level3" number="12.3.1">
<h3>
<span class="header-section-number">12.3.1</span> Select the last column<a class="anchor" aria-label="anchor" href="#select-the-last-column"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb223"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 344
## Columns: 1
## $ flipper_range &lt;fct&gt; small, small, medium, NA, medium, small, small, medium, …</code></pre>
<p>You can also select <code>n-to-the-last</code> with <code><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col()</a></code></p>
<div class="sourceCode" id="cb225"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">last_col</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 344
## Columns: 1
## $ delta_13_c_o_oo &lt;dbl&gt; NA, -24.69454, -25.33302, NA, -25.32426, -25.29805, -2…</code></pre>
<div class="info">
<p>
Indexing starts at 0, so 1 indicates n-1.
</p>
</div>
</div>
<div id="selecting-columns-based-on-string" class="section level3" number="12.3.2">
<h3>
<span class="header-section-number">12.3.2</span> Selecting columns based on string<a class="anchor" aria-label="anchor" href="#selecting-columns-based-on-string"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb227"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="st">"s"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 344
Columns: 5
$ study_name    &lt;chr&gt; "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708"…
$ sample_number &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 24,…
$ species       &lt;chr&gt; "Adelie Penguin (Pygoscelis adeliae)", "Adelie Penguin (Pygoscelis adeliae)", "Adelie …
$ stage         &lt;chr&gt; "Adult, 1 Egg Stage", "Adult, 1 Egg Stage", "Adult, 1 Egg Stage", "Adult, 1 Egg Stage"…
$ sex           &lt;chr&gt; "MALE", "FEMALE", "FEMALE", NA, "FEMALE", "MALE", "FEMALE", "MALE", NA, NA, NA, NA, "F…
</code></pre>
<p><code>starts_with</code> and <code>ends_with</code> works with any character, but also with a vector of characters</p>
<div class="sourceCode" id="cb229"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">starts_with</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"s"</span>, <span class="st">"c"</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 344
Columns: 9
$ study_name        &lt;chr&gt; "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0…
$ sample_number     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,…
$ species           &lt;chr&gt; "Adelie Penguin (Pygoscelis adeliae)", "Adelie Penguin (Pygoscelis adeliae)", "Ade…
$ stage             &lt;chr&gt; "Adult, 1 Egg Stage", "Adult, 1 Egg Stage", "Adult, 1 Egg Stage", "Adult, 1 Egg St…
$ sex               &lt;chr&gt; "MALE", "FEMALE", "FEMALE", NA, "FEMALE", "MALE", "FEMALE", "MALE", NA, NA, NA, NA…
$ clutch_completion &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "No", "No", "Yes", "Yes", "Yes", "Yes", …
$ culmen_length_mm  &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, 42.0, 37.8, 37.8, 41.1, 38.6, …
$ culmen_depth_mm   &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, 20.2, 17.1, 17.3, 17.6, 21.2, …
$ comments          &lt;chr&gt; "Not enough blood for isotopes.", NA, NA, "Adult not sampled.", NA, NA, "Nest neve…</code></pre>
<div id="contains" class="section level4" number="12.3.2.1">
<h4>
<span class="header-section-number">12.3.2.1</span> Contains<a class="anchor" aria-label="anchor" href="#contains"><i class="fas fa-link"></i></a>
</h4>
<p>We can also use the <code><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains()</a></code> function to search for columns that contain a specific string, it searches for an exact match to your string (no regular expressions) but is case-insensitive</p>
<div class="sourceCode" id="cb231"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"length"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 344
Columns: 2
$ culmen_length_mm  &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, 42.0, 37.8, 37.8, 41.1, 38.6, …
$ flipper_length_mm &lt;dbl&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186, 180, 182, 191, 198, 185, 195…</code></pre>
</div>
<div id="regular-expressions" class="section level4" number="12.3.2.2">
<h4>
<span class="header-section-number">12.3.2.2</span> Regular expressions<a class="anchor" aria-label="anchor" href="#regular-expressions"><i class="fas fa-link"></i></a>
</h4>
<p><a href="https://help.relativity.com/RelativityOne/Content/Relativity/Regular_expressions/Searching_with_regular_expressions.htm#" class="uri">https://help.relativity.com/RelativityOne/Content/Relativity/Regular_expressions/Searching_with_regular_expressions.htm#</a>:~:text=For%20example%2C%20%E2%80%9C%5Cd%E2%80%9D,that%20follow%20a%20specific%20pattern.</p>
<div class="sourceCode" id="cb233"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"[0-9]"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 344
Columns: 2
$ delta_15_n_o_oo &lt;dbl&gt; NA, 8.94956, 8.36821, NA, 8.76651, 8.66496, 9.18718, 9.46060, NA, 9.13362, 8.63243, …
$ delta_13_c_o_oo &lt;dbl&gt; NA, -24.69454, -25.33302, NA, -25.32426, -25.29805, -25.21799, -24.89958, NA, -25.09…
</code></pre>
<div class="sourceCode" id="cb235"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"[0-9]"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb236"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">matches</a></span><span class="op">(</span><span class="st">"length_[a-z][a-z]"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="selecting-by-column-type" class="section level4" number="12.3.2.3">
<h4>
<span class="header-section-number">12.3.2.3</span> Selecting by column type<a class="anchor" aria-label="anchor" href="#selecting-by-column-type"><i class="fas fa-link"></i></a>
</h4>
<p>The where function is used when you want to select variables of a specific data type in a dataset. For example, you can use it to select character variables.</p>
<div class="sourceCode" id="cb237"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.character</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 344
Columns: 10
$ study_name        &lt;chr&gt; "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0708", "PAL0…
$ species           &lt;chr&gt; "Adelie Penguin (Pygoscelis adeliae)", "Adelie Penguin (Pygoscelis adeliae)", "Ade…
$ region            &lt;chr&gt; "Anvers", "Anvers", "Anvers", "Anvers", "Anvers", "Anvers", "Anvers", "Anvers", "A…
$ island            &lt;chr&gt; "Torgersen", "Torgersen", "Torgersen", "Torgersen", "Torgersen", "Torgersen", "Tor…
$ stage             &lt;chr&gt; "Adult, 1 Egg Stage", "Adult, 1 Egg Stage", "Adult, 1 Egg Stage", "Adult, 1 Egg St…
$ individual_id     &lt;chr&gt; "N1A1", "N1A2", "N2A1", "N2A2", "N3A1", "N3A2", "N4A1", "N4A2", "N5A1", "N5A2", "N…
$ clutch_completion &lt;chr&gt; "Yes", "Yes", "Yes", "Yes", "Yes", "Yes", "No", "No", "Yes", "Yes", "Yes", "Yes", …
$ date_egg          &lt;chr&gt; "11/11/2007", "11/11/2007", "16/11/2007", "16/11/2007", "16/11/2007", "16/11/2007"…
$ sex               &lt;chr&gt; "MALE", "FEMALE", "FEMALE", NA, "FEMALE", "MALE", "FEMALE", "MALE", NA, NA, NA, NA…
$ comments          &lt;chr&gt; "Not enough blood for isotopes.", NA, NA, "Adult not sampled.", NA, NA, "Nest neve…</code></pre>
<p>Other "predicate functions" include</p>
<ul>
<li><p>is.double</p></li>
<li><p>is.numeric</p></li>
<li><p>is.logical</p></li>
<li><p>is.factor</p></li>
<li><p>is.integer</p></li>
</ul>
</div>
<div id="combos" class="section level4" number="12.3.2.4">
<h4>
<span class="header-section-number">12.3.2.4</span> Combos<a class="anchor" aria-label="anchor" href="#combos"><i class="fas fa-link"></i></a>
</h4>
<p>Using standard logical operators such as <code>|</code> and <code>&amp;</code> we can string toether different combinations of selection criteria</p>
<div class="sourceCode" id="cb239"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span> <span class="op">|</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"species"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>Rows: 344
Columns: 8
$ sample_number     &lt;dbl&gt; 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, 21, 22, 23,…
$ culmen_length_mm  &lt;dbl&gt; 39.1, 39.5, 40.3, NA, 36.7, 39.3, 38.9, 39.2, 34.1, 42.0, 37.8, 37.8, 41.1, 38.6, …
$ culmen_depth_mm   &lt;dbl&gt; 18.7, 17.4, 18.0, NA, 19.3, 20.6, 17.8, 19.6, 18.1, 20.2, 17.1, 17.3, 17.6, 21.2, …
$ flipper_length_mm &lt;dbl&gt; 181, 186, 195, NA, 193, 190, 181, 195, 193, 190, 186, 180, 182, 191, 198, 185, 195…
$ body_mass_g       &lt;dbl&gt; 3750, 3800, 3250, NA, 3450, 3650, 3625, 4675, 3475, 4250, 3300, 3700, 3200, 3800, …
$ delta_15_n_o_oo   &lt;dbl&gt; NA, 8.94956, 8.36821, NA, 8.76651, 8.66496, 9.18718, 9.46060, NA, 9.13362, 8.63243…
$ delta_13_c_o_oo   &lt;dbl&gt; NA, -24.69454, -25.33302, NA, -25.32426, -25.29805, -25.21799, -24.89958, NA, -25.…
$ species           &lt;chr&gt; "Adelie Penguin (Pygoscelis adeliae)", "Adelie Penguin (Pygoscelis adeliae)", "Ade…
</code></pre>
</div>
</div>
</div>
<div id="modifying-variables" class="section level2" number="12.4">
<h2>
<span class="header-section-number">12.4</span> Modifying variables<a class="anchor" aria-label="anchor" href="#modifying-variables"><i class="fas fa-link"></i></a>
</h2>
<div id="count" class="section level3" number="12.4.1">
<h3>
<span class="header-section-number">12.4.1</span> count<a class="anchor" aria-label="anchor" href="#count"><i class="fas fa-link"></i></a>
</h3>
</div>
<div id="extract" class="section level3" number="12.4.2">
<h3>
<span class="header-section-number">12.4.2</span> extract<a class="anchor" aria-label="anchor" href="#extract"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb241"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/separate.html">separate</a></span><span class="op">(</span><span class="va">species</span>,</span>
<span>          into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"common name"</span>, <span class="st">"latin name"</span><span class="op">)</span>,</span>
<span>          sep <span class="op">=</span> <span class="st">"\\("</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<p>This approach reaches its limits quite quickly - note here it has left an ugly <code>)</code> on the end of the second column. There are also issues when we lack a clear separator to distinguish the columns we want to create. For these use cases we have extract.</p>
<p>Now suppose you want to separate the common names and latin names of the species variable by regex:</p>
<div class="sourceCode" id="cb242"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/extract.html">extract</a></span><span class="op">(</span><span class="va">species</span>,</span>
<span>          into <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"common name"</span>, <span class="st">"latin name"</span><span class="op">)</span>,</span>
<span>          regex <span class="op">=</span> <span class="st">"(\\w+) .* \\(([^)]+)\\)"</span></span>
<span>          <span class="op">)</span></span></code></pre></div>
<ul>
<li><p>The first group captures at least 1 letter (\w+).</p></li>
<li><p>The column is then followed by a space, and all characters in between are followed by
another space: .*</p></li>
<li><p>The last group contains anything found inside brackets <code>()</code></p></li>
</ul>
</div>
</div>
<div id="factors-1" class="section level2" number="12.5">
<h2>
<span class="header-section-number">12.5</span> Factors<a class="anchor" aria-label="anchor" href="#factors-1"><i class="fas fa-link"></i></a>
</h2>
<div id="anonymising-factors" class="section level3" number="12.5.1">
<h3>
<span class="header-section-number">12.5.1</span> anonymising factors<a class="anchor" aria-label="anchor" href="#anonymising-factors"><i class="fas fa-link"></i></a>
</h3>
<p>Sometimes you want to make your data completely anonymous so that other people can’t see sensitive information. Or because you wish to blind you own analyses.</p>
<p><code><a href="https://forcats.tidyverse.org/reference/fct_anon.html">forcats::fct_anon</a></code></p>
<div class="sourceCode" id="cb243"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_anon.html">fct_anon</a></span><span class="op">(</span><span class="va">species</span>,</span>
<span>         prefix <span class="op">=</span> <span class="st">"species_"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="lump-factors" class="section level3" number="12.5.2">
<h3>
<span class="header-section-number">12.5.2</span> lump factors<a class="anchor" aria-label="anchor" href="#lump-factors"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb244"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>body_size <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_lump.html">fct_lump_min</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">body_size</span>,</span>
<span>         y <span class="op">=</span> <span class="va">flipper_length_mm</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="ordering-factors" class="section level3" number="12.5.3">
<h3>
<span class="header-section-number">12.5.3</span> ordering factors<a class="anchor" aria-label="anchor" href="#ordering-factors"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb245"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_relevel.html">fct_relevel</a></span><span class="op">(</span><span class="va">species</span>, <span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>, <span class="st">"Gentoo"</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-tidyverse_files/figure-html/unnamed-chunk-26-1.png" width="100%" style="display: block; margin: auto;"></div>
<p>With the function <code>fct_infreq</code> we can change the order according to how frequently each level occurs</p>
<div class="sourceCode" id="cb246"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_inorder.html">fct_infreq</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-tidyverse_files/figure-html/unnamed-chunk-27-1.png" width="100%" style="display: block; margin: auto;"></div>
<div class="sourceCode" id="cb247"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_rev.html">fct_rev</a></span><span class="op">(</span><span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/coord_flip.html">coord_flip</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-tidyverse_files/figure-html/unnamed-chunk-28-1.png" width="100%" style="display: block; margin: auto;"></div>
<p><code>fct_reorder</code> allows us to order the levels based on another continuous variable</p>
<div class="sourceCode" id="cb248"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>species <span class="op">=</span> <span class="fu"><a href="https://forcats.tidyverse.org/reference/as_factor.html">as_factor</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>           <span class="fu"><a href="https://forcats.tidyverse.org/reference/fct_reorder.html">fct_reorder</a></span><span class="op">(</span><span class="va">body_mass_g</span>,</span>
<span>                       .fun <span class="op">=</span> <span class="va">median</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="co"># by default the levels are ordered by the median values of the continuous variable</span></span>
<span>  <span class="co"># mean, min and max can all be included here</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">species</span>,</span>
<span>             y <span class="op">=</span> <span class="va">body_mass_g</span>,</span>
<span>             colour <span class="op">=</span> <span class="va">species</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_boxplot.html">geom_boxplot</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span>,</span>
<span>               outlier.shape <span class="op">=</span> <span class="cn">NA</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>width <span class="op">=</span> <span class="fl">.2</span>,</span>
<span>              alpha <span class="op">=</span> <span class="fl">.4</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-tidyverse_files/figure-html/unnamed-chunk-29-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
<div id="applying-functions-across-columns" class="section level3" number="12.5.4">
<h3>
<span class="header-section-number">12.5.4</span> applying functions across columns<a class="anchor" aria-label="anchor" href="#applying-functions-across-columns"><i class="fas fa-link"></i></a>
</h3>
<div id="calculate-summary-statistics-across-columns" class="section level4" number="12.5.4.1">
<h4>
<span class="header-section-number">12.5.4.1</span> calculate summary statistics across columns<a class="anchor" aria-label="anchor" href="#calculate-summary-statistics-across-columns"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb249"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    mean_body_mass <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>    mean_flipper_length <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">flipper_length_mm</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb250"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>      .cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>,</span>
<span>      .fns <span class="op">=</span> <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.x</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span>,</span>
<span>      .names <span class="op">=</span> <span class="st">"mean_{.col}"</span><span class="op">)</span></span>
<span>    <span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="22%">
<col width="10%">
<col width="11%">
<col width="11%">
<col width="12%">
<col width="9%">
<col width="11%">
<col width="11%">
</colgroup>
<thead><tr class="header">
<th align="left">species</th>
<th align="right">mean_sample_number</th>
<th align="right">mean_culmen_length_mm</th>
<th align="right">mean_culmen_depth_mm</th>
<th align="right">mean_flipper_length_mm</th>
<th align="right">mean_body_mass_g</th>
<th align="right">mean_delta_15_n_o_oo</th>
<th align="right">mean_delta_13_c_o_oo</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="right">76.5</td>
<td align="right">38.79139</td>
<td align="right">18.34636</td>
<td align="right">189.9536</td>
<td align="right">3700.662</td>
<td align="right">8.859733</td>
<td align="right">-25.80419</td>
</tr>
<tr class="even">
<td align="left">Chinstrap penguin (Pygoscelis antarctica)</td>
<td align="right">34.5</td>
<td align="right">48.83382</td>
<td align="right">18.42059</td>
<td align="right">195.8235</td>
<td align="right">3733.088</td>
<td align="right">9.356155</td>
<td align="right">-24.54654</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">62.5</td>
<td align="right">47.50488</td>
<td align="right">14.98211</td>
<td align="right">217.1870</td>
<td align="right">5076.016</td>
<td align="right">8.245338</td>
<td align="right">-26.18530</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="change-variable-types-across-columns" class="section level4" number="12.5.4.2">
<h4>
<span class="header-section-number">12.5.4.2</span> change variable types across columns<a class="anchor" aria-label="anchor" href="#change-variable-types-across-columns"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb251"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"species"</span>, <span class="st">"island"</span>, <span class="st">"region"</span><span class="op">)</span>,</span>
<span>           .fns <span class="op">=</span> <span class="va">as_factor</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.factor</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code>## Rows: 344
## Columns: 4
## $ species       &lt;fct&gt; Adelie Penguin (Pygoscelis adeliae), Adelie Penguin (Pyg…
## $ region        &lt;fct&gt; Anvers, Anvers, Anvers, Anvers, Anvers, Anvers, Anvers, …
## $ island        &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgersen, T…
## $ flipper_range &lt;fct&gt; small, small, medium, NA, medium, small, small, medium, …</code></pre>
<pre><code>Rows: 344
Columns: 3
$ species &lt;fct&gt; Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adelie, Adel…
$ region  &lt;fct&gt; Anvers, Anvers, Anvers, Anvers, Anvers, Anvers, Anvers, Anvers, Anvers, Anve…
$ island  &lt;fct&gt; Torgersen, Torgersen, Torgersen, Torgersen, Torgersen, Torgersen, Torgersen,…</code></pre>
</div>
<div id="correct-typos" class="section level4" number="12.5.4.3">
<h4>
<span class="header-section-number">12.5.4.3</span> correct typos<a class="anchor" aria-label="anchor" href="#correct-typos"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb254"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Adelie"</span>, <span class="st">"adelie"</span>, <span class="st">"pinstrap"</span>, <span class="st">"Chinstrap"</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"adelie"</span>, <span class="st">"Adelie"</span>, <span class="st">"Chinstrap"</span>,<span class="st">"Chinstrap"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">typo_df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">x</span>,<span class="va">y</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb255"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">typo_df</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">across</a></span><span class="op">(</span></span>
<span>    .cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/everything.html">everything</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>    .fns <span class="op">=</span> <span class="op">~</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/case_when.html">case_when</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"adelie"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"adelie"</span>, <span class="st">"Adelie"</span><span class="op">)</span>,</span>
<span>      <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_detect.html">str_detect</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"pinstrap"</span><span class="op">)</span> <span class="op">~</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">.</span>, <span class="st">"pinstrap"</span>, <span class="st">"Chinstrap"</span><span class="op">)</span>,</span>
<span>      <span class="cn">TRUE</span> <span class="op">~</span> <span class="va">.</span></span>
<span>    <span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">x</th>
<th align="left">y</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Adelie</td>
<td align="left">Adelie</td>
</tr>
<tr class="even">
<td align="left">Adelie</td>
<td align="left">Adelie</td>
</tr>
<tr class="odd">
<td align="left">Chinstrap</td>
<td align="left">Chinstrap</td>
</tr>
<tr class="even">
<td align="left">Chinstrap</td>
<td align="left">Chinstrap</td>
</tr>
</tbody>
</table></div>
</div>
</div>
</div>
</div>
<div id="working-with-rows" class="section level2" number="12.6">
<h2>
<span class="header-section-number">12.6</span> Working with rows<a class="anchor" aria-label="anchor" href="#working-with-rows"><i class="fas fa-link"></i></a>
</h2>
<div id="filtering-rows-based-on-conditions-across-multiple-columns" class="section level3" number="12.6.1">
<h3>
<span class="header-section-number">12.6.1</span> Filtering rows based on conditions across multiple columns<a class="anchor" aria-label="anchor" href="#filtering-rows-based-on-conditions-across-multiple-columns"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb256"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_any</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"culmen"</span><span class="op">)</span>,</span>
<span>           .fns <span class="op">=</span> <span class="op">~</span><span class="va">.</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb257"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_all</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/starts_with.html">contains</a></span><span class="op">(</span><span class="st">"culmen"</span><span class="op">)</span>,</span>
<span>           .fns <span class="op">=</span> <span class="op">~</span><span class="va">.</span> <span class="op">&lt;</span> <span class="fl">40</span><span class="op">)</span></span>
<span>  <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://pillar.r-lib.org/reference/glimpse.html">glimpse</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="filter-rows-based-on-missing-values" class="section level3" number="12.6.2">
<h3>
<span class="header-section-number">12.6.2</span> filter rows based on missing values<a class="anchor" aria-label="anchor" href="#filter-rows-based-on-missing-values"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb258"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span></span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/across.html">if_all</a></span><span class="op">(</span>.cols <span class="op">=</span> <span class="fu"><a href="https://tidyselect.r-lib.org/reference/where.html">where</a></span><span class="op">(</span><span class="va">is.numeric</span><span class="op">)</span>,</span>
<span>           .fns <span class="op">=</span> <span class="op">~</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span><span class="op">(</span><span class="va">.</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span> </span></code></pre></div>
<div class="try">
<p>
At first the outcome above can seem counter-intuitive, but can be
explained by the <code>!</code> operator. The if_all is evaluating
whether all columns meet the condition of NOT containing NA.
</p>
<p>
You can try different combinations of if_all, if_any and the NOT
operator
</p>
</div>
</div>
<div id="slicing" class="section level3" number="12.6.3">
<h3>
<span class="header-section-number">12.6.3</span> slicing<a class="anchor" aria-label="anchor" href="#slicing"><i class="fas fa-link"></i></a>
</h3>
<div class="sourceCode" id="cb259"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="4%">
<col width="5%">
<col width="12%">
<col width="2%">
<col width="2%">
<col width="6%">
<col width="5%">
<col width="6%">
<col width="4%">
<col width="6%">
<col width="5%">
<col width="6%">
<col width="4%">
<col width="1%">
<col width="5%">
<col width="5%">
<col width="3%">
<col width="5%">
<col width="5%">
</colgroup>
<thead><tr class="header">
<th align="left">study_name</th>
<th align="right">sample_number</th>
<th align="left">species</th>
<th align="left">region</th>
<th align="left">island</th>
<th align="left">stage</th>
<th align="left">individual_id</th>
<th align="left">clutch_completion</th>
<th align="left">date_egg</th>
<th align="right">culmen_length_mm</th>
<th align="right">culmen_depth_mm</th>
<th align="right">flipper_length_mm</th>
<th align="right">body_mass_g</th>
<th align="left">sex</th>
<th align="right">delta_15_n_o_oo</th>
<th align="right">delta_13_c_o_oo</th>
<th align="left">comments</th>
<th align="left">date_egg_proper</th>
<th align="left">flipper_range</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">PAL0708</td>
<td align="right">18</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N39A2</td>
<td align="left">Yes</td>
<td align="left">27/11/2007</td>
<td align="right">49.2</td>
<td align="right">15.2</td>
<td align="right">221</td>
<td align="right">6300</td>
<td align="left">MALE</td>
<td align="right">8.27376</td>
<td align="right">-25.00169</td>
<td align="left">NA</td>
<td align="left">2007-11-27</td>
<td align="left">large</td>
</tr>
<tr class="even">
<td align="left">PAL0708</td>
<td align="right">34</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N56A2</td>
<td align="left">Yes</td>
<td align="left">03/12/2007</td>
<td align="right">59.6</td>
<td align="right">17.0</td>
<td align="right">230</td>
<td align="right">6050</td>
<td align="left">MALE</td>
<td align="right">7.76843</td>
<td align="right">-25.68210</td>
<td align="left">NA</td>
<td align="left">2007-12-03</td>
<td align="left">large</td>
</tr>
<tr class="odd">
<td align="left">PAL0809</td>
<td align="right">78</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N58A2</td>
<td align="left">Yes</td>
<td align="left">06/11/2008</td>
<td align="right">51.1</td>
<td align="right">16.3</td>
<td align="right">220</td>
<td align="right">6000</td>
<td align="left">MALE</td>
<td align="right">8.40327</td>
<td align="right">-26.76821</td>
<td align="left">NA</td>
<td align="left">2008-11-06</td>
<td align="left">large</td>
</tr>
<tr class="even">
<td align="left">PAL0910</td>
<td align="right">118</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N36A2</td>
<td align="left">Yes</td>
<td align="left">01/12/2009</td>
<td align="right">48.8</td>
<td align="right">16.2</td>
<td align="right">222</td>
<td align="right">6000</td>
<td align="left">MALE</td>
<td align="right">8.33825</td>
<td align="right">-25.88547</td>
<td align="left">NA</td>
<td align="left">2009-12-01</td>
<td align="left">large</td>
</tr>
<tr class="odd">
<td align="left">PAL0809</td>
<td align="right">80</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N60A2</td>
<td align="left">Yes</td>
<td align="left">09/11/2008</td>
<td align="right">45.2</td>
<td align="right">16.4</td>
<td align="right">223</td>
<td align="right">5950</td>
<td align="left">MALE</td>
<td align="right">8.19749</td>
<td align="right">-26.65931</td>
<td align="left">NA</td>
<td align="left">2008-11-09</td>
<td align="left">large</td>
</tr>
<tr class="even">
<td align="left">PAL0910</td>
<td align="right">112</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N32A2</td>
<td align="left">Yes</td>
<td align="left">20/11/2009</td>
<td align="right">49.8</td>
<td align="right">15.9</td>
<td align="right">229</td>
<td align="right">5950</td>
<td align="left">MALE</td>
<td align="right">8.29226</td>
<td align="right">-26.21019</td>
<td align="left">NA</td>
<td align="left">2009-11-20</td>
<td align="left">large</td>
</tr>
<tr class="odd">
<td align="left">PAL0708</td>
<td align="right">14</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N37A2</td>
<td align="left">Yes</td>
<td align="left">29/11/2007</td>
<td align="right">48.4</td>
<td align="right">14.6</td>
<td align="right">213</td>
<td align="right">5850</td>
<td align="left">MALE</td>
<td align="right">7.82080</td>
<td align="right">-25.48025</td>
<td align="left">NA</td>
<td align="left">2007-11-29</td>
<td align="left">large</td>
</tr>
<tr class="even">
<td align="left">PAL0708</td>
<td align="right">16</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N38A2</td>
<td align="left">Yes</td>
<td align="left">03/12/2007</td>
<td align="right">49.3</td>
<td align="right">15.7</td>
<td align="right">217</td>
<td align="right">5850</td>
<td align="left">MALE</td>
<td align="right">8.07137</td>
<td align="right">-25.52473</td>
<td align="left">NA</td>
<td align="left">2007-12-03</td>
<td align="left">large</td>
</tr>
<tr class="odd">
<td align="left">PAL0910</td>
<td align="right">116</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N35A2</td>
<td align="left">Yes</td>
<td align="left">25/11/2009</td>
<td align="right">55.1</td>
<td align="right">16.0</td>
<td align="right">230</td>
<td align="right">5850</td>
<td align="left">MALE</td>
<td align="right">8.08354</td>
<td align="right">-26.18161</td>
<td align="left">NA</td>
<td align="left">2009-11-25</td>
<td align="left">large</td>
</tr>
<tr class="even">
<td align="left">PAL0809</td>
<td align="right">68</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N51A2</td>
<td align="left">Yes</td>
<td align="left">09/11/2008</td>
<td align="right">49.5</td>
<td align="right">16.2</td>
<td align="right">229</td>
<td align="right">5800</td>
<td align="left">MALE</td>
<td align="right">8.49854</td>
<td align="right">-26.74809</td>
<td align="left">NA</td>
<td align="left">2008-11-09</td>
<td align="left">large</td>
</tr>
</tbody>
</table></div>
</div>
<div class="sourceCode" id="cb260"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"row_number"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">123</span>,<span class="fl">307</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="3%">
<col width="3%">
<col width="4%">
<col width="12%">
<col width="2%">
<col width="2%">
<col width="5%">
<col width="4%">
<col width="5%">
<col width="3%">
<col width="5%">
<col width="4%">
<col width="5%">
<col width="3%">
<col width="2%">
<col width="4%">
<col width="4%">
<col width="11%">
<col width="4%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">row_number</th>
<th align="left">study_name</th>
<th align="right">sample_number</th>
<th align="left">species</th>
<th align="left">region</th>
<th align="left">island</th>
<th align="left">stage</th>
<th align="left">individual_id</th>
<th align="left">clutch_completion</th>
<th align="left">date_egg</th>
<th align="right">culmen_length_mm</th>
<th align="right">culmen_depth_mm</th>
<th align="right">flipper_length_mm</th>
<th align="right">body_mass_g</th>
<th align="left">sex</th>
<th align="right">delta_15_n_o_oo</th>
<th align="right">delta_13_c_o_oo</th>
<th align="left">comments</th>
<th align="left">date_egg_proper</th>
<th align="left">flipper_range</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">1</td>
<td align="left">PAL0708</td>
<td align="right">18</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N39A2</td>
<td align="left">Yes</td>
<td align="left">27/11/2007</td>
<td align="right">49.2</td>
<td align="right">15.2</td>
<td align="right">221</td>
<td align="right">6300</td>
<td align="left">MALE</td>
<td align="right">8.27376</td>
<td align="right">-25.00169</td>
<td align="left">NA</td>
<td align="left">2007-11-27</td>
<td align="left">large</td>
</tr>
<tr class="even">
<td align="left">123</td>
<td align="left">PAL0809</td>
<td align="right">59</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N17A1</td>
<td align="left">Yes</td>
<td align="left">06/11/2008</td>
<td align="right">43.2</td>
<td align="right">14.5</td>
<td align="right">208</td>
<td align="right">4450</td>
<td align="left">FEMALE</td>
<td align="right">8.48367</td>
<td align="right">-26.86485</td>
<td align="left">NA</td>
<td align="left">2008-11-06</td>
<td align="left">medium</td>
</tr>
<tr class="odd">
<td align="left">307</td>
<td align="left">PAL0708</td>
<td align="right">17</td>
<td align="left">Chinstrap penguin (Pygoscelis antarctica)</td>
<td align="left">Anvers</td>
<td align="left">Dream</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N71A1</td>
<td align="left">No</td>
<td align="left">30/11/2007</td>
<td align="right">50.3</td>
<td align="right">20.0</td>
<td align="right">197</td>
<td align="right">3300</td>
<td align="left">MALE</td>
<td align="right">10.02019</td>
<td align="right">-24.54704</td>
<td align="left">Nest never observed with full clutch.</td>
<td align="left">2007-11-30</td>
<td align="left">medium</td>
</tr>
</tbody>
</table></div>
</div>
<div class="sourceCode" id="cb261"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html">desc</a></span><span class="op">(</span><span class="va">body_mass_g</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/rownames.html">rownames_to_column</a></span><span class="op">(</span>var <span class="op">=</span> <span class="st">"row_number"</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span><span class="op">:</span><span class="op">-</span><span class="fl">340</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table style="width:100%;" class="table table-sm">
<colgroup>
<col width="3%">
<col width="3%">
<col width="4%">
<col width="12%">
<col width="2%">
<col width="2%">
<col width="5%">
<col width="4%">
<col width="5%">
<col width="3%">
<col width="4%">
<col width="4%">
<col width="5%">
<col width="3%">
<col width="2%">
<col width="4%">
<col width="4%">
<col width="16%">
<col width="4%">
<col width="4%">
</colgroup>
<thead><tr class="header">
<th align="left">row_number</th>
<th align="left">study_name</th>
<th align="right">sample_number</th>
<th align="left">species</th>
<th align="left">region</th>
<th align="left">island</th>
<th align="left">stage</th>
<th align="left">individual_id</th>
<th align="left">clutch_completion</th>
<th align="left">date_egg</th>
<th align="right">culmen_length_mm</th>
<th align="right">culmen_depth_mm</th>
<th align="right">flipper_length_mm</th>
<th align="right">body_mass_g</th>
<th align="left">sex</th>
<th align="right">delta_15_n_o_oo</th>
<th align="right">delta_13_c_o_oo</th>
<th align="left">comments</th>
<th align="left">date_egg_proper</th>
<th align="left">flipper_range</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">341</td>
<td align="left">PAL0809</td>
<td align="right">65</td>
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N29A1</td>
<td align="left">Yes</td>
<td align="left">13/11/2008</td>
<td align="right">36.4</td>
<td align="right">17.1</td>
<td align="right">184</td>
<td align="right">2850</td>
<td align="left">FEMALE</td>
<td align="right">8.62623</td>
<td align="right">-26.11650</td>
<td align="left">NA</td>
<td align="left">2008-11-13</td>
<td align="left">small</td>
</tr>
<tr class="even">
<td align="left">342</td>
<td align="left">PAL0809</td>
<td align="right">39</td>
<td align="left">Chinstrap penguin (Pygoscelis antarctica)</td>
<td align="left">Anvers</td>
<td align="left">Dream</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N72A1</td>
<td align="left">No</td>
<td align="left">24/11/2008</td>
<td align="right">46.9</td>
<td align="right">16.6</td>
<td align="right">192</td>
<td align="right">2700</td>
<td align="left">FEMALE</td>
<td align="right">9.80589</td>
<td align="right">-24.73735</td>
<td align="left">Nest never observed with full clutch.</td>
<td align="left">2008-11-24</td>
<td align="left">medium</td>
</tr>
<tr class="odd">
<td align="left">343</td>
<td align="left">PAL0708</td>
<td align="right">4</td>
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="left">Anvers</td>
<td align="left">Torgersen</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N2A2</td>
<td align="left">Yes</td>
<td align="left">16/11/2007</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Adult not sampled.</td>
<td align="left">2007-11-16</td>
<td align="left">NA</td>
</tr>
<tr class="even">
<td align="left">344</td>
<td align="left">PAL0910</td>
<td align="right">120</td>
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Anvers</td>
<td align="left">Biscoe</td>
<td align="left">Adult, 1 Egg Stage</td>
<td align="left">N38A2</td>
<td align="left">No</td>
<td align="left">01/12/2009</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="left">Adult not sampled. Nest never observed with full clutch.</td>
<td align="left">2009-12-01</td>
<td align="left">NA</td>
</tr>
</tbody>
</table></div>
</div>
<p>Helper functions include <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_head()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_tail()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max()</a></code>, <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_min()</a></code> and <code><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample()</a></code>
We can use these functions to more quickly and easily filter our data under some situations</p>
<div class="sourceCode" id="cb262"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">body_mass_g</span>,</span>
<span>            n <span class="op">=</span> <span class="fl">20</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="co"># we can also use prop e.g. prop =.1 to slice the top 10%</span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">body_mass_g</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">species</th>
<th align="right">body_mass_g</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">6300</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">6050</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">6000</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">6000</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5950</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5950</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5850</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5850</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5850</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5800</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5800</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5750</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5700</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5700</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5700</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5700</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5700</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5650</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5650</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">5650</td>
</tr>
</tbody>
</table></div>
</div>
<div id="groupwise-slicing" class="section level4" number="12.6.3.1">
<h4>
<span class="header-section-number">12.6.3.1</span> groupwise slicing<a class="anchor" aria-label="anchor" href="#groupwise-slicing"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb263"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_max</a></span><span class="op">(</span>order_by <span class="op">=</span> <span class="va">body_mass_g</span>,</span>
<span>            n <span class="op">=</span> <span class="fl">3</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">body_mass_g</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">ungroup</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">species</th>
<th align="right">body_mass_g</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="right">4775</td>
</tr>
<tr class="even">
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="right">4725</td>
</tr>
<tr class="odd">
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="right">4700</td>
</tr>
<tr class="even">
<td align="left">Chinstrap penguin (Pygoscelis antarctica)</td>
<td align="right">4800</td>
</tr>
<tr class="odd">
<td align="left">Chinstrap penguin (Pygoscelis antarctica)</td>
<td align="right">4550</td>
</tr>
<tr class="even">
<td align="left">Chinstrap penguin (Pygoscelis antarctica)</td>
<td align="right">4500</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">6300</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">6050</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">6000</td>
</tr>
<tr class="even">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="right">6000</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="bootstrapping-with-slice" class="section level4" number="12.6.3.2">
<h4>
<span class="header-section-number">12.6.3.2</span> bootstrapping with slice<a class="anchor" aria-label="anchor" href="#bootstrapping-with-slice"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb264"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">342</span><span class="op">)</span></span>
<span><span class="va">bootstraps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="op">~</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/slice.html">slice_sample</a></span><span class="op">(</span><span class="va">penguins</span>, prop <span class="op">=</span> <span class="fl">.1</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">bootstraps</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>    <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map_dbl</a></span><span class="op">(</span><span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.</span><span class="op">$</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">_</span> <span class="op">)</span> <span class="op">|&gt;</span> </span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_histogram.html">geom_histogram</a></span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"grey80"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_abline.html">geom_vline</a></span><span class="op">(</span>data <span class="op">=</span> <span class="va">penguins</span>,</span>
<span>             <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>xintercept <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span>,</span>
<span>             linewidth <span class="op">=</span> <span class="fl">2</span>, colour <span class="op">=</span> <span class="st">"red"</span>, linetype  <span class="op">=</span><span class="st">"dashed"</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="04-tidyverse_files/figure-html/unnamed-chunk-44-1.png" width="100%" style="display: block; margin: auto;"></div>
</div>
</div>
</div>
<div id="group-work" class="section level2" number="12.7">
<h2>
<span class="header-section-number">12.7</span> Group work<a class="anchor" aria-label="anchor" href="#group-work"><i class="fas fa-link"></i></a>
</h2>
<p>The R4DS book demonstrates how functions can be used to run multiple models simultaneously. This technique is valuable for extracting meaningful insights from your data. A well-known example of this approach involves the Gapminder dataset. We will cover a brief version here:</p>
<p>To find out how well culmen length can predict culmen depth we build a linear regression model.</p>
<p>Once we have created the model, we can retrieve the results parameters and test statistics
with the summary function:
<code>summary(model)</code></p>
<div class="sourceCode" id="cb265"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">culmen_depth_mm</span> <span class="op">~</span> <span class="va">culmen_length_mm</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>## 
## Call:
## lm(formula = culmen_depth_mm ~ culmen_length_mm, data = penguins)
## 
## Residuals:
##     Min      1Q  Median      3Q     Max 
## -4.1381 -1.4263  0.0164  1.3841  4.5255 
## 
## Coefficients:
##                  Estimate Std. Error t value Pr(&gt;|t|)    
## (Intercept)      20.88547    0.84388  24.749  &lt; 2e-16 ***
## culmen_length_mm -0.08502    0.01907  -4.459 1.12e-05 ***
## ---
## Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1
## 
## Residual standard error: 1.922 on 340 degrees of freedom
##   (2 observations deleted due to missingness)
## Multiple R-squared:  0.05525,    Adjusted R-squared:  0.05247 
## F-statistic: 19.88 on 1 and 340 DF,  p-value: 1.12e-05</code></pre>
<p>Now we know that there are important covariates to consider - and the most appropriate method from an analysis perspective would be to include these as covariates within a single model</p>
<div class="sourceCode" id="cb267"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">culmen_depth_mm</span> <span class="op">~</span> <span class="va">culmen_length_mm</span> <span class="op">*</span> <span class="va">species</span>, data <span class="op">=</span> <span class="va">penguins</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<pre><code>Call:
lm(formula = culmen_depth_mm ~ culmen_length_mm * species, data = penguins)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.6574 -0.6675 -0.0524  0.5383  3.5032 

Coefficients:
                                  Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)                       11.40912    1.13812  10.025  &lt; 2e-16 ***
culmen_length_mm                   0.17883    0.02927   6.110 2.76e-09 ***
speciesChinstrap                  -3.83998    2.05398  -1.870 0.062419 .  
speciesGentoo                     -6.15812    1.75451  -3.510 0.000509 ***
culmen_length_mm:speciesChinstrap  0.04338    0.04558   0.952 0.341895    
culmen_length_mm:speciesGentoo     0.02601    0.04054   0.642 0.521590    
---
Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1

Residual standard error: 0.9548 on 336 degrees of freedom
  (2 observations deleted due to missingness)
Multiple R-squared:  0.7697,    Adjusted R-squared:  0.7662 
F-statistic: 224.5 on 5 and 336 DF,  p-value: &lt; 2.2e-16
</code></pre>
<p>However, there may be occasions where we wish to apply simple models to each subpopulation in turn:</p>
<div class="sourceCode" id="cb269"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>model <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">data</span>, <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">culmen_depth_mm</span> <span class="op">~</span> <span class="va">culmen_length_mm</span>, data <span class="op">=</span> <span class="va">.</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>tidy <span class="op">=</span> <span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span><span class="va">model</span>, <span class="fu">broom</span><span class="fu">::</span><span class="va"><a href="https://generics.r-lib.org/reference/tidy.html">tidy</a></span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">tidy</span><span class="op">)</span></span></code></pre></div>
<pre><code>A tibble:6 × 8
Groups:species [3]

Adelie  &lt;tibble&gt;    &lt;S3: lm&gt;    (Intercept) 11.4091245  1.33893250  
Adelie  &lt;tibble&gt;    &lt;S3: lm&gt;    culmen_length_mm    0.1788343   0.03443569  
Gentoo  &lt;tibble&gt;    &lt;S3: lm&gt;    (Intercept) 5.2510084   1.05480901  
Gentoo  &lt;tibble&gt;    &lt;S3: lm&gt;    culmen_length_mm    0.2048443   0.02215802  
Chinstrap   &lt;tibble&gt;    &lt;S3: lm&gt;    (Intercept) 7.5691401   1.55052928  
Chinstrap   &lt;tibble&gt;    &lt;S3: lm&gt;    culmen_length_mm    0.2222117   0.03167825  
6 rows | 1-6 of 8 columns
</code></pre>
</div>
<div id="pivot" class="section level2" number="12.8">
<h2>
<span class="header-section-number">12.8</span> Pivot<a class="anchor" aria-label="anchor" href="#pivot"><i class="fas fa-link"></i></a>
</h2>
<div id="pivot-wider" class="section level3" number="12.8.1">
<h3>
<span class="header-section-number">12.8.1</span> pivot wider<a class="anchor" aria-label="anchor" href="#pivot-wider"><i class="fas fa-link"></i></a>
</h3>
<div class="info">
<p>
Un-tidy data violates one of these three principles in one way or
another:
</p>
<p>
• Each variable forms a column • Each observation forms a row • Each
type of observation unit is a table
</p>
</div>
<div class="sourceCode" id="cb271"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">wk1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">4</span>,<span class="fl">5</span><span class="op">)</span></span>
<span><span class="va">wk2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">3</span>,<span class="fl">4</span>,<span class="fl">1</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">wk3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">0</span>,<span class="fl">2</span>,<span class="fl">0</span><span class="op">)</span></span>
<span><span class="va">penguin_id</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"N15A1"</span> , <span class="st">"N15A2"</span> , <span class="st">"N18A1"</span>, <span class="st">"N71A2"</span><span class="op">)</span></span>
<span></span>
<span><span class="va">peng_obs</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span><span class="op">(</span><span class="va">penguin_id</span>, <span class="va">wk1</span>,<span class="va">wk2</span>,<span class="va">wk3</span><span class="op">)</span></span></code></pre></div>
<p>This data is untidy because a value that measures the same underlying attribute (number of observations) is split across three columns. Here wk1,wk2 and wk3 represent the underlying variable of observations split across three weeks.</p>
<p>We can use pivot to create a tidy representation of the data</p>
<div class="sourceCode" id="cb272"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peng_obs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="st">"wk1"</span><span class="op">:</span><span class="st">"wk3"</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"week"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"observations"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">penguin_id</th>
<th align="left">week</th>
<th align="right">observations</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">N15A1</td>
<td align="left">wk1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">N15A1</td>
<td align="left">wk2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">N15A1</td>
<td align="left">wk3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">N15A2</td>
<td align="left">wk1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">N15A2</td>
<td align="left">wk2</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">N15A2</td>
<td align="left">wk3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">N18A1</td>
<td align="left">wk1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">N18A1</td>
<td align="left">wk2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">N18A1</td>
<td align="left">wk3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">N71A2</td>
<td align="left">wk1</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">N71A2</td>
<td align="left">wk2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">N71A2</td>
<td align="left">wk3</td>
<td align="right">0</td>
</tr>
</tbody>
</table></div>
</div>
<p>We can tidy this dataframe further by removing the "wk" prefix:</p>
<div class="sourceCode" id="cb273"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peng_obs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="st">"wk1"</span><span class="op">:</span><span class="st">"wk3"</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"week"</span>,</span>
<span>    names_prefix <span class="op">=</span> <span class="st">"wk"</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"observations"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">penguin_id</th>
<th align="left">week</th>
<th align="right">observations</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">N15A1</td>
<td align="left">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">N15A1</td>
<td align="left">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">N15A1</td>
<td align="left">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">N15A2</td>
<td align="left">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">N15A2</td>
<td align="left">2</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">N15A2</td>
<td align="left">3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">N18A1</td>
<td align="left">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">N18A1</td>
<td align="left">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">N18A1</td>
<td align="left">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">N71A2</td>
<td align="left">1</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">N71A2</td>
<td align="left">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">N71A2</td>
<td align="left">3</td>
<td align="right">0</td>
</tr>
</tbody>
</table></div>
</div>
<div class="warning">
<p>
Note that the week column is still being treated as a character
string. using <code>names_transform</code> we can fix this
</p>
</div>
<div class="sourceCode" id="cb274"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">peng_obs</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_longer.html">pivot_longer</a></span><span class="op">(</span></span>
<span>    cols <span class="op">=</span> <span class="st">"wk1"</span><span class="op">:</span><span class="st">"wk3"</span>,</span>
<span>    names_to <span class="op">=</span> <span class="st">"week"</span>,</span>
<span>    names_prefix <span class="op">=</span> <span class="st">"wk"</span>,</span>
<span>    names_transform <span class="op">=</span> <span class="va">as.integer</span>,</span>
<span>    values_to <span class="op">=</span> <span class="st">"observations"</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">penguin_id</th>
<th align="right">week</th>
<th align="right">observations</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">N15A1</td>
<td align="right">1</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td align="left">N15A1</td>
<td align="right">2</td>
<td align="right">3</td>
</tr>
<tr class="odd">
<td align="left">N15A1</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">N15A2</td>
<td align="right">1</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td align="left">N15A2</td>
<td align="right">2</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">N15A2</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
<tr class="odd">
<td align="left">N18A1</td>
<td align="right">1</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td align="left">N18A1</td>
<td align="right">2</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td align="left">N18A1</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td align="left">N71A2</td>
<td align="right">1</td>
<td align="right">5</td>
</tr>
<tr class="odd">
<td align="left">N71A2</td>
<td align="right">2</td>
<td align="right">0</td>
</tr>
<tr class="even">
<td align="left">N71A2</td>
<td align="right">3</td>
<td align="right">0</td>
</tr>
</tbody>
</table></div>
</div>
</div>
<div id="pivot-longer" class="section level3" number="12.8.2">
<h3>
<span class="header-section-number">12.8.2</span> pivot longer<a class="anchor" aria-label="anchor" href="#pivot-longer"><i class="fas fa-link"></i></a>
</h3>
<p>Suppose you would like to make a data frame wider because you would like to present the results in a human-readable table. To do this, you can use pivot_wider and provide arguments for its main parameters:</p>
<ul>
<li><p>id_cols: These columns are the identifiers for the observations. These column names
remain unchanged in the data frame. Their values form the rows of the transformed data
frame. By default, all columns except those specified in names_from and values_from
become id_cols.</p></li>
<li><p>names_from: These columns will be transformed into a wider format. Their values will
be converted to columns. If you specify more than one column for names_from, the
newly created column names will be a combination of the column values.</p></li>
<li><p>values_from: The values of these columns will be used for the columns created with
names_from.</p></li>
</ul>
<div id="pivot-wider-for-summary-tables" class="section level4" number="12.8.2.1">
<h4>
<span class="header-section-number">12.8.2.1</span> pivot wider for summary tables<a class="anchor" aria-label="anchor" href="#pivot-wider-for-summary-tables"><i class="fas fa-link"></i></a>
</h4>
<div class="sourceCode" id="cb275"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">island</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<thead><tr class="header">
<th align="left">species</th>
<th align="left">island</th>
<th align="right">mean</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="left">Biscoe</td>
<td align="right">3709.659</td>
</tr>
<tr class="even">
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="left">Dream</td>
<td align="right">3688.393</td>
</tr>
<tr class="odd">
<td align="left">Adelie Penguin (Pygoscelis adeliae)</td>
<td align="left">Torgersen</td>
<td align="right">3706.373</td>
</tr>
<tr class="even">
<td align="left">Chinstrap penguin (Pygoscelis antarctica)</td>
<td align="left">Dream</td>
<td align="right">3733.088</td>
</tr>
<tr class="odd">
<td align="left">Gentoo penguin (Pygoscelis papua)</td>
<td align="left">Biscoe</td>
<td align="right">5076.016</td>
</tr>
</tbody>
</table></div>
</div>
<div class="sourceCode" id="cb276"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">penguins</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html">group_by</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">island</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html">summarise</a></span><span class="op">(</span>mean <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">body_mass_g</span>, na.rm <span class="op">=</span> <span class="cn">T</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>  <span class="fu"><a href="https://tidyr.tidyverse.org/reference/pivot_wider.html">pivot_wider</a></span><span class="op">(</span>names_from <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">species</span>, <span class="va">island</span><span class="op">)</span>,</span>
<span>              values_from <span class="op">=</span> <span class="va">mean</span>,</span>
<span>              names_prefix <span class="op">=</span> <span class="st">"mean_"</span><span class="op">)</span></span></code></pre></div>
<div class="kable-table">
<div class="inline-table"><table class="table table-sm">
<colgroup>
<col width="19%">
<col width="19%">
<col width="20%">
<col width="21%">
<col width="18%">
</colgroup>
<thead><tr class="header">
<th align="right">mean_Adelie Penguin (Pygoscelis adeliae)_Biscoe</th>
<th align="right">mean_Adelie Penguin (Pygoscelis adeliae)_Dream</th>
<th align="right">mean_Adelie Penguin (Pygoscelis adeliae)_Torgersen</th>
<th align="right">mean_Chinstrap penguin (Pygoscelis antarctica)_Dream</th>
<th align="right">mean_Gentoo penguin (Pygoscelis papua)_Biscoe</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">3709.659</td>
<td align="right">3688.393</td>
<td align="right">3706.373</td>
<td align="right">3733.088</td>
<td align="right">5076.016</td>
</tr></tbody>
</table></div>
</div>
</div>
</div>
</div>
<div id="writing-functions-in-tidyverse" class="section level2" number="12.9">
<h2>
<span class="header-section-number">12.9</span> Writing Functions in Tidyverse<a class="anchor" aria-label="anchor" href="#writing-functions-in-tidyverse"><i class="fas fa-link"></i></a>
</h2>
<p>Understanding the Tidyverse's consistent syntax and style.
Writing functions using the tidy evaluation framework (quo, !!).
Creating custom functions that integrate seamlessly with the Tidyverse.</p>

</div>
</div>



<script>

/* update total correct if #webex-total_correct exists */
update_total_correct = function() {
  console.log("webex: update total_correct");

  if (t = document.getElementById("webex-total_correct")) {
    var correct = document.getElementsByClassName("webex-correct").length;
    var solvemes = document.getElementsByClassName("webex-solveme").length;
    var radiogroups = document.getElementsByClassName("webex-radiogroup").length;
    var selects = document.getElementsByClassName("webex-select").length;
    
    t.innerHTML = correct + " of " + (solvemes + radiogroups + selects) + " correct";
  }
}

/* webex-solution button toggling function */
b_func = function() {
  console.log("webex: toggle hide");
  
  var cl = this.parentElement.classList;
  if (cl.contains('open')) {
    cl.remove("open");
  } else {
    cl.add("open");
  }
}

/* function for checking solveme answers */
solveme_func = function(e) {
  console.log("webex: check solveme");

  var real_answers = JSON.parse(this.dataset.answer);
  var my_answer = this.value;
  var cl = this.classList;
  if (cl.contains("ignorecase")) {
    my_answer = my_answer.toLowerCase();
  }
  if (cl.contains("nospaces")) {
    my_answer = my_answer.replace(/ /g, "")
  }

  if (my_answer == "") {
    cl.remove("webex-correct");
    cl.remove("webex-incorrect");
  } else if (real_answers.includes(my_answer)) {
    cl.add("webex-correct");
    cl.remove("webex-incorrect");
  } else {
    cl.add("webex-incorrect");
    cl.remove("webex-correct");
  }

  // match numeric answers within a specified tolerance
  if(this.dataset.tol > 0){
    var tol = JSON.parse(this.dataset.tol);
    var matches = real_answers.map(x => Math.abs(x - my_answer) < tol)
    if (matches.reduce((a, b) => a + b, 0) > 0) {
      cl.add("webex-correct");
    } else {
      cl.remove("webex-correct");
    }
  }

  // added regex bit
  if (cl.contains("regex")){
    answer_regex = RegExp(real_answers.join("|"))
    if (answer_regex.test(my_answer)) {
      cl.add("webex-correct");
    }
  }

  update_total_correct();
}

/* function for checking select answers */
select_func = function(e) {
  console.log("webex: check select");
  
  var cl = this.classList
  
  /* add style */
  cl.remove("webex-incorrect");
  cl.remove("webex-correct");
  if (this.value == "answer") {
    cl.add("webex-correct");
  } else if (this.value != "blank") {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

/* function for checking radiogroups answers */
radiogroups_func = function(e) {
  console.log("webex: check radiogroups");

  var checked_button = document.querySelector('input[name=' + this.id + ']:checked');
  var cl = checked_button.parentElement.classList;
  var labels = checked_button.parentElement.parentElement.children;
  
  /* get rid of styles */
  for (i = 0; i < labels.length; i++) {
    labels[i].classList.remove("webex-incorrect");
    labels[i].classList.remove("webex-correct");
  }
  
  /* add style */
  if (checked_button.value == "answer") {
    cl.add("webex-correct");
  } else {
    cl.add("webex-incorrect");
  }
  
  update_total_correct();
}

window.onload = function() {
  console.log("onload");
  /* set up solution buttons */
  var buttons = document.getElementsByTagName("button");

  for (var i = 0; i < buttons.length; i++) {
    if (buttons[i].parentElement.classList.contains('webex-solution')) {
      buttons[i].onclick = b_func;
    }
  }

  /* set up webex-solveme inputs */
  var solveme = document.getElementsByClassName("webex-solveme");

  for (var i = 0; i < solveme.length; i++) {
    /* make sure input boxes don't auto-anything */
    solveme[i].setAttribute("autocomplete","off");
    solveme[i].setAttribute("autocorrect", "off");
    solveme[i].setAttribute("autocapitalize", "off");
    solveme[i].setAttribute("spellcheck", "false");
    solveme[i].value = "";

    /* adjust answer for ignorecase or nospaces */
    var cl = solveme[i].classList;
    var real_answer = solveme[i].dataset.answer;
    if (cl.contains("ignorecase")) {
      real_answer = real_answer.toLowerCase();
    }
    if (cl.contains("nospaces")) {
      real_answer = real_answer.replace(/ /g, "");
    }
    solveme[i].dataset.answer = real_answer;

    /* attach checking function */
    solveme[i].onkeyup = solveme_func;
    solveme[i].onchange = solveme_func;
  }
  
  /* set up radiogroups */
  var radiogroups = document.getElementsByClassName("webex-radiogroup");
  for (var i = 0; i < radiogroups.length; i++) {
    radiogroups[i].onchange = radiogroups_func;
  }
  
  /* set up selects */
  var selects = document.getElementsByClassName("webex-select");
  for (var i = 0; i < selects.length; i++) {
    selects[i].onchange = select_func;
  }

  update_total_correct();
}

</script><script>
$( document ).ready(function() {
  var cite = ' ';
  var license = ' <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/" target="blank"><img alt="Creative Commons License" style="border-width:0" src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png"></a>';

  $("footer div.row div:eq(1) p").html(
    license
  );
});
</script><div class="chapter-nav">
<div class="prev"><a href="bonus-simulation.html"><span class="header-section-number">11</span> Bonus: Simulation</a></div>
<div class="next"><a href="data-visualisation-with-ggplot2.html"><span class="header-section-number">13</span> Data visualisation with ggplot2</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#getting-the-most-out-of-tidyverse"><span class="header-section-number">12</span> Getting the most out of tidyverse</a></li>
<li>
<a class="nav-link" href="#reading-files-with-readr"><span class="header-section-number">12.1</span> Reading files with readr</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#cleaning-column-names"><span class="header-section-number">12.1.1</span> Cleaning column names</a></li>
<li><a class="nav-link" href="#selecting-columns"><span class="header-section-number">12.1.2</span> Selecting columns</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#reading-multiple-files"><span class="header-section-number">12.2</span> Reading multiple files</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#create-a-vector-of-file-paths"><span class="header-section-number">12.2.1</span> Create a vector of file paths</a></li>
<li><a class="nav-link" href="#read-multiple-files"><span class="header-section-number">12.2.2</span> Read multiple files</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#working-across-columns"><span class="header-section-number">12.3</span> Working across columns</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#select-the-last-column"><span class="header-section-number">12.3.1</span> Select the last column</a></li>
<li><a class="nav-link" href="#selecting-columns-based-on-string"><span class="header-section-number">12.3.2</span> Selecting columns based on string</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#modifying-variables"><span class="header-section-number">12.4</span> Modifying variables</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#count"><span class="header-section-number">12.4.1</span> count</a></li>
<li><a class="nav-link" href="#extract"><span class="header-section-number">12.4.2</span> extract</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#factors-1"><span class="header-section-number">12.5</span> Factors</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#anonymising-factors"><span class="header-section-number">12.5.1</span> anonymising factors</a></li>
<li><a class="nav-link" href="#lump-factors"><span class="header-section-number">12.5.2</span> lump factors</a></li>
<li><a class="nav-link" href="#ordering-factors"><span class="header-section-number">12.5.3</span> ordering factors</a></li>
<li><a class="nav-link" href="#applying-functions-across-columns"><span class="header-section-number">12.5.4</span> applying functions across columns</a></li>
</ul>
</li>
<li>
<a class="nav-link" href="#working-with-rows"><span class="header-section-number">12.6</span> Working with rows</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#filtering-rows-based-on-conditions-across-multiple-columns"><span class="header-section-number">12.6.1</span> Filtering rows based on conditions across multiple columns</a></li>
<li><a class="nav-link" href="#filter-rows-based-on-missing-values"><span class="header-section-number">12.6.2</span> filter rows based on missing values</a></li>
<li><a class="nav-link" href="#slicing"><span class="header-section-number">12.6.3</span> slicing</a></li>
</ul>
</li>
<li><a class="nav-link" href="#group-work"><span class="header-section-number">12.7</span> Group work</a></li>
<li>
<a class="nav-link" href="#pivot"><span class="header-section-number">12.8</span> Pivot</a><ul class="nav navbar-nav">
<li><a class="nav-link" href="#pivot-wider"><span class="header-section-number">12.8.1</span> pivot wider</a></li>
<li><a class="nav-link" href="#pivot-longer"><span class="header-section-number">12.8.2</span> pivot longer</a></li>
</ul>
</li>
<li><a class="nav-link" href="#writing-functions-in-tidyverse"><span class="header-section-number">12.9</span> Writing Functions in Tidyverse</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/UEABIO/physalia-intro-stats-2023/blob/main/book/04-tidyverse.Rmd">View source <i class="fab fa-github"></i></a></li>
          <li><a id="book-edit" href="https://github.com/UEABIO/physalia-intro-stats-2023/edit/main/book/04-tidyverse.Rmd">Edit this page <i class="fab fa-github"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container"><div class="row">

  <div class="col-12 col-md-6 mt-3">
    <p>"<strong>Advancing in R</strong>: A guide for Biologists and Ecologists" was written by Philip T. Leftwich. It was last built on 2023-10-26.</p>
  </div>

  <div class="col-12 col-md-6 mt-3">
    <p>This book was built by the <a class="text-light" href="https://bookdown.org">bookdown</a> R package.</p>
  </div>

</div></div>
</footer><!-- dynamically load mathjax for compatibility with self-contained --><script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script><script type="text/x-mathjax-config">const popovers = document.querySelectorAll('a.footnote-ref[data-toggle="popover"]');
for (let popover of popovers) {
  const div = document.createElement('div');
  div.setAttribute('style', 'position: absolute; top: 0, left:0; width:0, height:0, overflow: hidden; visibility: hidden;');
  div.innerHTML = popover.getAttribute('data-content');

  var has_math = div.querySelector("span.math");
  if (has_math) {
    document.body.appendChild(div);
    MathJax.Hub.Queue(["Typeset", MathJax.Hub, div]);
    MathJax.Hub.Queue(function() {
      popover.setAttribute('data-content', div.innerHTML);
      document.body.removeChild(div);
    })
  }
}
</script>
</body>
</html>
